"40ae48d5ef151e51ec38894559939d1f04bfc113"
[cl-struct-undo-tree [nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil (#1=[nil nil ((25941 . 25943)) nil (21657 21107 72095 906000) 0 nil]) ((#("p" 0 1 (fontified t)) . -25941) (undo-tree-id68 . -1) (undo-tree-id69 . -1) (undo-tree-id70 . -1)) nil (21657 21107 72111 561000) 0 nil]) ((#("m" 0 1 (fontified t)) . -25942) (undo-tree-id71 . -1) (undo-tree-id72 . -1)) nil (21657 21107 72118 201000) 0 nil]) ((25543 . 25544)) nil (21657 21107 72120 900000) 0 nil]) ((#("<" 0 1 (fontified t)) . -25543) (undo-tree-id73 . -1) (undo-tree-id74 . -1)) nil (21657 21107 72125 830000) 0 nil]) ((25542 . 25544)) nil (21657 21107 72128 300000) 0 nil]) ((#("m" 0 1 (fontified t)) . 25542) (undo-tree-id75 . -1) (undo-tree-id76 . -1) (undo-tree-id77 . -1) (undo-tree-id78 . -1) (undo-tree-id79 . -1) (undo-tree-id80 . -1) (undo-tree-id81 . -1) (undo-tree-id82 . -1) (undo-tree-id83 . -1)) nil (21657 21107 72146 650000) 0 nil]) ((#("p" 0 1 (fontified t)) . 25542) (undo-tree-id84 . -1)) nil (21657 21107 72151 660000) 0 nil] [nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil ([nil nil ((25938 . 25940)) ((#("PM" 0 2 (fontified t)) . 25938)) (21657 21090 295905 988000) 0 nil]) ((#("p" 0 1 (fontified t)) . -25938) (undo-tree-id53 . -1) (undo-tree-id54 . -1) (undo-tree-id55 . -1)) ((25938 . 25939)) (21657 21090 296137 822000) 0 nil]) ((#("m" 0 1 (fontified t)) . -25939) (undo-tree-id56 . -1) (undo-tree-id57 . -1)) ((25939 . 25940)) (21657 21090 955785 811000) 0 nil]) ((25539 . 25541)) ((#("PM" 0 2 (fontified t)) . 25539)) (21657 21090 995570 744000) 0 nil]) ((#("p" 0 1 (fontified t)) . -25539) (undo-tree-id58 . -1) (undo-tree-id59 . -1) (undo-tree-id60 . -1) (undo-tree-id61 . -1) (undo-tree-id62 . -1)) ((25539 . 25540)) (21657 21091 35520 694000) 0 nil]) ((#("m" 0 1 (fontified t)) . -25540) (undo-tree-id63 . -1) (undo-tree-id64 . -1) (undo-tree-id65 . -1)) ((25540 . 25541)) (21657 21091 75635 741000) 0 nil]) ((#("
" 0 1 (fontified t)) . 25514) (undo-tree-id66 . -1)) ((25514 . 25515)) (21657 21091 115577 861000) 0 nil]) ((#("
" 0 1 (fontified t)) . 25514)) ((25514 . 25515)) (21657 21091 155568 382000) 0 nil]) ((25045 . 25046)) ((#("s" 0 1 (fontified t)) . 25045)) (21657 21091 195438 631000) 0 nil]) ((#(";" 0 1 (fontified t)) . 25045) (undo-tree-id67 . -1)) ((25045 . 25046)) (21657 21091 235840 487000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25482) (25481 . 25482)) ((#(";" 0 1 (fontified nil)) . 25481) (25482 . 25483)) (21657 21091 275689 953000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25449) (25448 . 25449)) ((#(";" 0 1 (fontified nil)) . 25448) (25449 . 25450)) (21657 21091 575847 230000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25420) (25419 . 25420)) ((#(";" 0 1 (fontified nil)) . 25419) (25420 . 25421)) (21657 21092 315833 704000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25391) (25390 . 25391)) ((#(";" 0 1 (fontified nil)) . 25390) (25391 . 25392)) (21657 21092 318752 154000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25362) (25361 . 25362)) ((#(";" 0 1 (fontified nil)) . 25361) (25362 . 25363)) (21657 21092 321343 456000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25329) (25328 . 25329)) ((#(";" 0 1 (fontified nil)) . 25328) (25329 . 25330)) (21657 21092 355869 464000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25298) (25297 . 25298)) ((#(";" 0 1 (fontified nil)) . 25297) (25298 . 25299)) (21657 21092 395667 482000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25265) (25264 . 25265)) ((#(";" 0 1 (fontified nil)) . 25264) (25265 . 25266)) (21657 21092 436332 774000) 0 nil] [nil ([nil nil ((#("s" 0 1 (fontified nil)) . 25285) (25284 . 25285)) ((#(";" 0 1 (fontified nil)) . 25284) (undo-tree-id49 . -1) (undo-tree-id50 . -1) (25285 . 25286)) (21657 20956 656184 18000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25265) (25264 . 25265)) ((#(";" 0 1 (fontified nil)) . 25264) (undo-tree-id51 . -1) (undo-tree-id52 . -1) (25265 . 25266)) (21657 20956 656398 167000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25232) (25231 . 25232)) ((#(";" 0 1 (fontified nil)) . 25231) (25232 . 25233)) (21657 21092 475565 572000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25197) (25196 . 25197)) ((#(";" 0 1 (fontified nil)) . 25196) (25197 . 25198)) (21657 21092 515717 704000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25164) (25163 . 25164)) ((#(";" 0 1 (fontified nil)) . 25163) (25164 . 25165)) (21657 21092 555671 520000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25131) (25130 . 25131)) ((#(";" 0 1 (fontified nil)) . 25130) (25131 . 25132)) (21657 21092 596439 239000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25094) (25093 . 25094)) ((#(";" 0 1 (fontified nil)) . 25093) (25094 . 25095)) (21657 21092 637318 413000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25063) (25062 . 25063)) ((#(";" 0 1 (fontified nil)) . 25062) (25063 . 25064)) (21657 21092 677079 181000) 0 nil]) ((#("s" 0 1 (fontified nil)) . 25046) (25045 . 25046)) ((#(";" 0 1 (fontified nil)) . 25045) (25046 . 25047)) (21657 21092 717840 454000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 25022) (25021 . 25022)) ((#(";" 0 1 (fontified nil)) . 25021) (25022 . 25023)) (21657 21092 758993 802000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 24981) (24980 . 24981)) ((#(";" 0 1 (fontified nil)) . 24980) (24981 . 24982)) (21657 21092 798554 258000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 24938) (24937 . 24938)) ((#(";" 0 1 (fontified nil)) . 24937) (24938 . 24939)) (21657 21092 838627 92000) 0 nil]) ((#("
" 0 1 (fontified t)) . 24901) (undo-tree-id42 . -1) (undo-tree-id44 . -1)) ((24901 . 24902)) (21657 21093 151611 62000) 0 nil]) ((24900 . 24901)) ((#(";" 0 1 (fontified t)) . 24900)) (21657 21093 375597 214000) 0 nil]) ((#("
" 0 1 (fontified nil)) . 24870) (24869 . 24870)) ((#(";" 0 1 (fontified nil)) . 24869) (24870 . 24871)) (21657 21093 639557 927000) 0 nil]) ((#("
" 0 1 (fontified t)) . 24839) (undo-tree-id47 . -1)) ((24839 . 24840)) (21657 21093 951629 599000) 0 nil]) ((24838 . 24839)) nil (21657 21094 319904 380000) 0 nil]) ((26096 . 26097)) nil (21657 20956 656270 756000) 0 nil]) ((26021 . 26022)) nil (21657 20956 656272 715000) 0 nil]) ((25950 . 25951)) nil (21657 20956 656274 781000) 0 nil]) ((nil rear-nonsticky nil 25913 . 25914) (nil fontified nil 25913 . 25914) (#("
" 0 1 (face font-lock-comment-face fontified nil)) . -26310) (25913 . 26311)) nil (21657 20956 656277 783000) 0 nil] [nil nil ((nil rear-nonsticky nil 27522 . 27523) (nil fontified nil 25913 . 27523) (25913 . 27523)) ((#("
#check it does better
m1.formula <- as.formula(PM25~ aod+(1+aod|day))
x<-  lmer(m1.formula,data=m1.2004)
m1.2004$predicted <- predict(x)
glance(lm(PM25~predicted,data=m1.2004))
#get rid of missing
#m1.2004 <- na.omit(m1.2004)
m1.2004[,elev.s:= scale(elev)]
m1.2004[,tden.s:= scale(tden)]
m1.2004[,pden.s:= scale(pden)]
m1.2004[,dist2A1.s:= scale(dist2A1)]
m1.2004[,dist2water.s:= scale(dist2water)]
m1.2004[,dist2rail.s:= scale(dist2rail)]
m1.2004[,Dist2road.s:= scale(Dist2road)]
m1.2004[,ndvi.s:= scale(ndvi)]
m1.2004[,MeanPbl.s:= scale(MeanPbl)]
m1.2004[,p_ind.s:= scale(p_ind)]
m1.2004[,p_for.s:= scale(p_for)]
m1.2004[,p_farm.s:= scale(p_farm)]
m1.2004[,p_dos.s:= scale(p_dos)]
m1.2004[,p_dev.s:= scale(p_dev)]
m1.2004[,p_os.s:= scale(p_os)]
m1.2004[,tempa.s:= scale(tempa)]
m1.2004[,WDa.s:= scale(WDa)]
m1.2004[,WSa.s:= scale(WSa)]
m1.2004[,RHa.s:= scale(RHa)]
m1.2004[,Raina.s:= scale(Raina)]
m1.2004[,NO2a.s:= scale(NO2a)]



m1.formula <- as.formula(PM25~ aod
                        +tempa.s+WDa.s+WSa.s+Dust+MeanPbl.s #temporal
                        +elev.s+tden.s+pden.s+Dist2road.s+ndvi.s #spatial
                        +p_os.s #+p_dev.s+p_dos.s+p_farm.s+p_for.s+p_ind.s  #land use
                         #+aod*Dust #interactions
                         +(1+aod|day/reg_num)) #+(1|stn) !!! stn screws up mod3 

#full fit
m1.fit.2004 <-  lmer(m1.formula,data=m1.2004,weights=normwt)
m1.2004$pred.m1 <- predict(m1.fit.2004)
res[res$year==\"2004\", 'm1.R2'] <- print(summary(lm(PM25~pred.m1,data=m1.2004))$r.squared)
#RMSPE
res[res$year==\"2004\", 'm1.PE'] <- print(rmse(residuals(m1.fit.2004)))
" 0 1 (fontified nil) 1 2 (fontified nil face font-lock-comment-delimiter-face) 2 23 (fontified nil face font-lock-comment-face) 23 34 (fontified nil) 34 36 (fontified nil face font-lock-constant-face) 36 72 (fontified nil) 72 74 (fontified nil face font-lock-constant-face) 74 124 (fontified nil) 124 126 (fontified nil face font-lock-constant-face) 126 178 (fontified nil) 178 179 (fontified nil face font-lock-comment-delimiter-face) 179 198 (fontified nil face font-lock-comment-face) 198 199 (fontified nil face font-lock-comment-delimiter-face) 199 227 (fontified nil face font-lock-comment-face) 227 513 (fontified nil) 513 946 (fontified nil) 946 948 (fontified nil face font-lock-constant-face) 948 1030 (fontified nil) 1030 1031 (fontified nil face font-lock-comment-delimiter-face) 1031 1040 (fontified nil face font-lock-comment-face) 1040 1105 (fontified nil) 1105 1106 (fontified nil face font-lock-comment-delimiter-face) 1106 1114 (fontified nil face font-lock-comment-face) 1114 1146 (fontified nil) 1146 1147 (fontified nil face font-lock-comment-delimiter-face) 1147 1200 (fontified nil face font-lock-comment-face) 1200 1225 (fontified nil) 1225 1226 (fontified nil face font-lock-comment-delimiter-face) 1226 1250 (fontified nil face font-lock-comment-face) 1250 1297 (fontified nil) 1297 1298 (fontified nil face font-lock-comment-delimiter-face) 1298 1331 (fontified nil face font-lock-comment-face) 1331 1332 (fontified nil) 1332 1333 (fontified nil face font-lock-comment-delimiter-face) 1333 1342 (fontified nil face font-lock-comment-face) 1342 1354 (fontified nil) 1354 1356 (fontified nil face font-lock-constant-face) 1356 1419 (fontified nil) 1419 1421 (fontified nil face font-lock-constant-face) 1421 1457 (fontified nil) 1457 1463 (fontified nil face font-lock-string-face) 1463 1465 (fontified nil) 1465 1472 (fontified nil face font-lock-string-face) 1472 1474 (fontified nil) 1474 1476 (fontified nil face font-lock-constant-face) 1476 1533 (fontified nil) 1533 1534 (fontified nil face font-lock-comment-delimiter-face) 1534 1540 (fontified nil face font-lock-comment-face) 1540 1554 (fontified nil) 1554 1560 (fontified nil face font-lock-string-face) 1560 1562 (fontified nil) 1562 1569 (fontified nil face font-lock-string-face) 1569 1571 (fontified nil) 1571 1573 (fontified nil face font-lock-constant-face) 1573 1609 (fontified nil) 1609 1610 (fontified nil rear-nonsticky nil)) . 25913) (undo-tree-id36 . -1610) (undo-tree-id37 . -583) (undo-tree-id38 . -1609) (undo-tree-id39 . -1610) (undo-tree-id40 . -583) (nil fontified t 27447 . 27453) (nil fontified t 27446 . 27447) (nil fontified t 27389 . 27446) (nil fontified t 27387 . 27389) (nil fontified t 27385 . 27387) (nil fontified t 27378 . 27385) (nil fontified t 27376 . 27378) (nil fontified t 27370 . 27376) (nil fontified t 27334 . 27370) (nil fontified t 27332 . 27334) (nil fontified t 27269 . 27332) (nil fontified t 27267 . 27269) (nil fontified t 27255 . 27267) (nil fontified t 27246 . 27255) (nil fontified t 27245 . 27246) (nil fontified t 27244 . 27245) (nil fontified t 27211 . 27244) (nil fontified t 27210 . 27211) (nil fontified t 27163 . 27210) (nil fontified t 27139 . 27163) (nil fontified t 27138 . 27139) (nil fontified t 27113 . 27138) (nil fontified t 27060 . 27113) (nil fontified t 27059 . 27060) (nil fontified t 27027 . 27059) (nil fontified t 27019 . 27027) (nil fontified t 27018 . 27019) (nil fontified t 26953 . 27018) (nil fontified t 26944 . 26953) (nil fontified t 26943 . 26944) (nil fontified t 26861 . 26943) (nil fontified t 26859 . 26861) (nil fontified t 26426 . 26859) (nil fontified t 26140 . 26426) (nil fontified t 26112 . 26140) (nil fontified t 26111 . 26112) (nil fontified t 26092 . 26111) (nil fontified t 26091 . 26092) (nil fontified t 26039 . 26091) (nil fontified t 26037 . 26039) (nil fontified t 25987 . 26037) (nil fontified t 25985 . 25987) (nil fontified t 25949 . 25985) (nil fontified t 25947 . 25949) (nil fontified t 25936 . 25947) (nil fontified t 25915 . 25936) (nil fontified t 25914 . 25915) (nil fontified t 25913 . 25914) (nil rear-nonsticky t 27522 . 27523)) (21657 20860 792717 263000) 0 nil]) ((25912 . 25915)) nil (21657 20860 792907 158000) 0 nil]) ((25515 . 25912) (#("
m1.formula <- as.formula(PM25~ aod
                        +tempa.s+WDa.s+WSa.s+Dust+MeanPbl.s #temporal
                        +elev.s+tden.s+pden.s+Dist2road.s+ndvi.s #spatial
                        +p_os.s #+p_dev.s+p_dos.s+p_farm.s+p_for.s+p_ind.s  #land use
                         #+aod*Dust #interactions
                         +(1+aod|day/reg_num)) #+(1|stn) !!! stn screws up mod3 
" 0 12 (fontified t) 12 14 (fontified t face font-lock-constant-face) 14 96 (fontified t) 96 97 (fontified t face font-lock-comment-delimiter-face) 97 106 (fontified t face font-lock-comment-face) 106 171 (fontified t) 171 172 (fontified t face font-lock-comment-delimiter-face) 172 180 (fontified t face font-lock-comment-face) 180 212 (fontified t) 212 213 (fontified t face font-lock-comment-delimiter-face) 213 266 (fontified t face font-lock-comment-face) 266 291 (fontified t) 291 292 (fontified t face font-lock-comment-delimiter-face) 292 316 (fontified t face font-lock-comment-face) 316 363 (fontified t) 363 364 (fontified t face font-lock-comment-delimiter-face) 364 397 (fontified t face font-lock-comment-face)) . 25515)) nil (21657 20860 792725 12000) 0 nil] [nil ([nil ([nil nil ((289 . 290)) ((#(")" 0 1 (fontified t)) . 289) (undo-tree-id5 . -1)) (21657 20744 745012 334000) 0 nil]) ((280 . 289)) ((#("rary(keep" 0 4 (fontified t face font-lock-constant-face) 4 9 (fontified t)) . 280) (undo-tree-id6 . -1) (undo-tree-id7 . -2) (undo-tree-id8 . -3) (undo-tree-id9 . -4) (undo-tree-id10 . -5) (undo-tree-id11 . -6) (undo-tree-id12 . -7) (undo-tree-id13 . -8) (undo-tree-id14 . -9) (undo-tree-id15 . -9) (undo-tree-id16 . -9) (undo-tree-id17 . -8)) (21657 20744 745188 686000) 0 nil]) ((276 . 280)) ((#(";lib" 0 1 (fontified t) 1 4 (fontified t)) . 276) (undo-tree-id18 . -1) (undo-tree-id19 . -2) (undo-tree-id20 . -3) (undo-tree-id21 . -4) (undo-tree-id22 . -4) (undo-tree-id23 . -4) (undo-tree-id24 . -4) (undo-tree-id25 . -4) (undo-tree-id26 . -4) (undo-tree-id27 . -4) (undo-tree-id28 . -4) (undo-tree-id29 . -4) (undo-tree-id30 . -4) (undo-tree-id31 . -4) (undo-tree-id32 . -4) (undo-tree-id33 . -4) (undo-tree-id34 . -4) (undo-tree-id35 . -3)) (21657 20745 105281 714000) 0 nil]) ((#("0.04 &" 0 6 (fontified t)) . -46595) (46601 . 46606) (#("0.04 &" 0 6 (fontified t)) . -1510) (1516 . 1521)) nil (21657 20745 465292 225000) 0 nil]) (("0.04 &" . -205822) (205828 . 205833) ("0.04 &" . -183277) (183283 . 183288) ("0.04 &" . -160732) (160738 . 160743) ("0.04 &" . -138187) (138193 . 138198) ("0.04 &" . -115642) (115648 . 115653) ("0.04 &" . -91765) (91771 . 91776) (#("0.04 &" 0 6 (fontified t)) . -69142) (69148 . 69153)) nil (21657 20744 745031 51000) 0 nil]) ((24401 . 24402) (#("5" 0 1 (fontified t)) . 24401) (undo-tree-id0 . -1) (undo-tree-id1 . -1)) nil (21657 20744 745051 71000) 0 nil]) ((#("V" 0 1 (fontified t)) . 23384) (undo-tree-id2 . -1)) nil (21657 20744 745055 601000) 0 nil]) ((23384 . 23385)) nil (21657 20744 745057 964000) 0 nil]) ((#(" " 0 1 (fontified t)) . 472)) nil (21657 20744 745059 816000) 0 nil]) ((468 . 472)) nil (21657 20744 745062 313000) 0 nil]) ((464 . 468)) nil (21657 20744 745064 354000) 0 nil]) ((#("l" 0 1 (fontified t)) . -464) (undo-tree-id3 . -1)) nil (21657 20744 745067 536000) 0 nil]) ((461 . 465)) nil (21657 20744 745070 103000) 0 nil]) ((#("," 0 1 (fontified t)) . 461)) nil (21657 20744 745072 723000) 0 nil]) ((#("(" 0 1 (fontified t)) . -458) (undo-tree-id4 . -1)) nil (21657 20744 745076 734000) 0 nil]) ((#("S" 0 1 (fontified t)) . 458)) nil (21657 20744 745079 494000) 0 nil]) ((#("D" 0 1 (fontified t)) . 458)) nil (21657 20744 745081 790000) 0 nil]) ((#("R" 0 1 (fontified t)) . 458)) nil (21657 20744 745083 509000) 0 nil]) ((#("e" 0 1 (fontified t)) . 458)) nil (21657 20744 745085 379000) 0 nil]) ((#("v" 0 1 (fontified t)) . 458)) nil (21657 20744 745087 584000) 0 nil]) ((#("a" 0 1 (fontified t)) . 458)) nil (21657 20744 745089 828000) 0 nil]) ((#("s" 0 1 (fontified t)) . 458)) nil (21657 20744 745092 325000) 0 nil]) ((nil rear-nonsticky nil 562 . 563) (nil fontified nil 561 . 563) (nil fontified nil 471 . 561) (nil fontified nil 458 . 471) (458 . 563)) nil (21657 20744 745095 642000) 0 nil]) ((457 . 458)) nil (21657 20744 745097 759000) 0 nil]) ((452 . 457)) nil (21657 20744 745099 875000) 0 nil]) ((432 . 452)) nil (21657 20744 745102 14000) 0 nil]) ((431 . 433) (t 21656 62281 307008 101000)) nil (21657 20744 745104 84000) 0 nil]) nil nil (21657 20744 745105 596000) 0 nil] #1# 4663 77 nil]